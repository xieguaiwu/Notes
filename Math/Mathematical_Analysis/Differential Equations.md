---
tags:
  - Math
  - Calculus
  - 定义性
title: Differential Equations
created: 2026-02-06T18:51:00
modified:
---
# Differential Equations

## 1. 微分方程基本概念
[[differentiation]]
### 1.1 微分方程的定义

微分方程是含有未知函数及其导数的方程。

**例子**：
- $\frac{dy}{dx} = 2x$（一阶微分方程）
- $\frac{d^2y}{dx^2} + 4y = 0$（二阶微分方程）
- $y' = xy$（一阶微分方程）

### 1.2 微分方程的阶

微分方程的阶是指方程中出现的最高阶导数的阶数。

| 微分方程 | 阶数 |
|---------|------|
| $\frac{dy}{dx} = x$ | 1 |
| $\frac{d^2y}{dx^2} + \frac{dy}{dx} = 0$ | 2 |
| $y''' + y' = x$ | 3 |

### 1.3 微分方程的解

微分方程的解是指满足该微分方程的函数。

**通解**：包含任意常数的解，常数的个数等于微分方程的阶数。

**特解**：给定初始条件后确定的解。

**例子**：$\frac{dy}{dx} = 2x$
- 通解：$y = x^2 + C$
- 初始条件 $y(0) = 1$，特解：$y = x^2 + 1$

### 1.4 初始值问题

给定初始条件的微分方程问题称为初始值问题。

**例子**：
$$\frac{dy}{dx} = xy, \quad y(0) = 2$$

### 1.5 解的验证

要验证函数 $y = f(x)$ 是否是微分方程的解，将该函数及其导数代入微分方程，检验等式是否成立。

**例子**：验证 $y = Ce^{-x}$ 是否是 $y' + y = 0$ 的解
- $y' = -Ce^{-x}$
- $y' + y = -Ce^{-x} + Ce^{-x} = 0$
- 因此 $y = Ce^{-x}$ 是解

## 2. 分离变量法

### 2.1 可分离变量微分方程

**定义**：形如 $\frac{dy}{dx} = g(x)h(y)$ 的微分方程称为可分离变量的微分方程。

### 2.2 解法步骤
[[Indefinite Integration]]
1. 分离变量：$\frac{dy}{h(y)} = g(x) \, dx$
2. 两边积分：$\int \frac{dy}{h(y)} = \int g(x) \, dx$
3. 解出 y（用 x 表示）

### 2.3 例子

**题目**：解微分方程 $\frac{dy}{dx} = xy$

**解**：
1. 分离变量：$\frac{dy}{y} = x \, dx$
2. 积分：$\ln|y| = \frac{x^2}{2} + C$
3. 解出 y：$|y| = e^{x^2/2 + C} = e^C \cdot e^{x^2/2}$
4. 令 $C_1 = \pm e^C$（C₁ 为常数）：
   $$y = C_1 e^{x^2/2}$$

### 2.4 更多例子

**例子**：$\frac{dy}{dx} = \frac{x}{y}$

**解**：
1. 分离变量：$y \, dy = x \, dx$
2. 积分：$\frac{y^2}{2} = \frac{x^2}{2} + C$
3. 解出 y：$y^2 = x^2 + 2C = x^2 + C_1$
   $$y = \pm\sqrt{x^2 + C_1}$$

**例子**：$\frac{dy}{dx} = \frac{y}{x}$

**解**：
1. 分离变量：$\frac{dy}{y} = \frac{dx}{x}$
2. 积分：$\ln|y| = \ln|x| + C$
3. 解出 y：$|y| = e^{\ln|x| + C} = |x| \cdot e^C$
   $$y = C_1 x \quad (C_1 \neq 0)$$

## 3. 一阶线性微分方程

### 3.1 定义

一阶线性微分方程的标准形式为：
$$\frac{dy}{dx} + P(x)y = Q(x)$$

### 3.2 积分因子法

**积分因子**：
$$I(x) = e^{\int P(x) \, dx}$$

**求解步骤**：
1. 找到积分因子 $I(x)$
2. 方程两边同乘 $I(x)$
3. 左边变为 $\frac{d}{dx}[I(x) \cdot y]$
4. 积分得到解

### 3.3 例子

**题目**：解微分方程 $\frac{dy}{dx} + 2xy = x$
[[Definition of e]]
**解**：
1. 确定标准形式：$P(x) = 2x$，$Q(x) = x$
2. 计算积分因子：
   $$I(x) = e^{\int 2x \, dx} = e^{x^2}$$
3. 方程两边乘 $e^{x^2}$：
   $$e^{x^2} \frac{dy}{dx} + 2xy e^{x^2} = x e^{x^2}$$
4. 左边可以写成：
   $$\frac{d}{dx}[y e^{x^2}] = x e^{x^2}$$
5. 积分：
   $$y e^{x^2} = \int x e^{x^2} \, dx = \frac{1}{2}e^{x^2} + C$$
6. 解出 y：
   $$y = \frac{1}{2} + Ce^{-x^2}$$

## 4. 齐次微分方程

### 4.1 齐次微分方程的定义

形如 $\frac{dy}{dx} = f\left(\frac{y}{x}\right)$ 的微分方程称为齐次微分方程。

### 4.2 解法步骤

令 $v = \frac{y}{x}$，则 $y = vx$，$\frac{dy}{dx} = v + x\frac{dv}{dx}$

代入原方程后可分离变量求解。

### 4.3 例子

**题目**：解微分方程 $\frac{dy}{dx} = \frac{y - x}{x + y}$

**解**：
1. 将右边写成 $\frac{y}{x}$ 的函数：
   $$\frac{dy}{dx} = \frac{\frac{y}{x} - 1}{1 + \frac{y}{x}}$$
2. 令 $v = \frac{y}{x}$，则 $y = vx$，$\frac{dy}{dx} = v + x\frac{dv}{dx}$
3. 代入：
   $$v + x\frac{dv}{dx} = \frac{v - 1}{1 + v}$$
4. 分离变量：
   $$x\frac{dv}{dx} = \frac{v - 1}{1 + v} - v = \frac{v - 1 - v(1 + v)}{1 + v} = \frac{-1 - v^2}{1 + v}$$
   $$\frac{1 + v}{1 + v^2} \, dv = -\frac{dx}{x}$$
5. 积分：
   $$\int \frac{1 + v}{1 + v^2} \, dv = -\int \frac{dx}{x}$$
   $$\arctan v + \frac{1}{2}\ln(1 + v^2) = -\ln|x| + C$$
6. 代回 $v = \frac{y}{x}$：
   $$\arctan\left(\frac{y}{x}\right) + \frac{1}{2}\ln\left(1 + \frac{y^2}{x^2}\right) = -\ln|x| + C$$

## 5. 斜率场（方向场）

### 5.1 斜率场的定义

斜率场是指在平面坐标系上，通过在各点画出代表该点处微分方程 $\frac{dy}{dx} = f(x, y)$ 的解的斜率的小线段，从而形成的图形。

### 5.2 绘制斜率场

在点 $(x, y)$ 处，线段的斜率等于 $f(x, y)$。

**例子**：$\frac{dy}{dx} = x + y$

在点 $(0, 0)$ 处，斜率 $= 0 + 0 = 0$（水平线）
在点 $(1, 0)$ 处，斜率 $= 1 + 0 = 1$（斜率为1）
在点 $(0, 1)$ 处，斜率 $= 0 + 1 = 1$（斜率为1）

### 5.3 斜率场的应用

- 可以可视化微分方程的解
- 帮助理解解的性质（是否存在平衡点、趋势等）
- 可以用作图法近似求解微分方程

### 5.4 平衡点（常数解）

如果 $\frac{dy}{dx} = 0$，则 $y$ 为常数，称为平衡点或常数解。

**例子**：$\frac{dy}{dx} = y(1 - y)$

令 $\frac{dy}{dx} = 0$：
- $y = 0$（平衡点）
- $y = 1$（平衡点）

## 6. 欧拉方法（Euler's Method）

### 6.1 欧拉方法的原理

欧拉方法是一种数值方法，用于近似求解微分方程。

### 6.2 欧拉方法的公式

给定微分方程 $\frac{dy}{dx} = f(x, y)$ 和初始条件 $y(x_0) = y_0$，步长为 $h$：

$$y_{n+1} = y_n + h \cdot f(x_n, y_n)$$
$$x_{n+1} = x_n + h$$

其中：
- $x_n = x_0 + nh$
- $y_n$ 是 $y(x_n)$ 的近似值

### 6.3 例子

**题目**：使用欧拉方法近似求解 $\frac{dy}{dx} = x + y$，初始条件 $y(0) = 1$，步长 $h = 0.1$，计算 $y(0.2)$ 的近似值。

**解**：
1. $x_0 = 0$，$y_0 = 1$
2. 第一步：
   - $f(x_0, y_0) = 0 + 1 = 1$
   - $y_1 = y_0 + h \cdot f(x_0, y_0) = 1 + 0.1 \times 1 = 1.1$
   - $x_1 = 0 + 0.1 = 0.1$
3. 第二步：
   - $f(x_1, y_1) = 0.1 + 1.1 = 1.2$
   - $y_2 = y_1 + h \cdot f(x_1, y_1) = 1.1 + 0.1 \times 1.2 = 1.22$
   - $x_2 = 0.1 + 0.1 = 0.2$
4. 因此 $y(0.2) \approx 1.22$

## 7. 微分方程的应用

### 7.1 指数增长与衰减

**微分方程**：$\frac{dP}{dt} = kP$

**解**：$P(t) = P_0 e^{kt}$

其中：
- $P(t)$ 是时刻 t 的人口或数量
- $k$ 是增长率（$k > 0$ 为增长，$k < 0$ 为衰减）
- $P_0$ 是初始人口

**应用**：细菌生长、放射性衰变、复利等

### 7.2 冷却定律（牛顿冷却定律）

**微分方程**：$\frac{dT}{dt} = k(T - T_s)$

**解**：$T(t) = T_s + (T_0 - T_s)e^{kt}$

其中：
- $T(t)$ 是物体在时刻 t 的温度
- $T_s$ 是周围环境的温度
- $T_0$ 是物体的初始温度
- $k$ 是冷却常数（$k < 0$）

### 7.3 逻辑斯谛增长

**微分方程**：$\frac{dP}{dt} = kP\left(1 - \frac{P}{M}\right)$

**解**：$P(t) = \frac{M}{1 + Ae^{-kt}}$，其中 $A = \frac{M - P_0}{P_0}$

其中：
- $P(t)$ 是时刻 t 的人口
- $M$ 是环境承载能力（最大人口）
- $k$ 是增长率
- $P_0$ 是初始人口

**性质**：
- 平衡点：$P = 0$ 和 $P = M$
- 当 $P \to M$ 时，增长率趋于 0

### 7.4 混合问题

**微分方程**：$\frac{dQ}{dt} = \text{流入速率} - \text{流出速率}$

**例子**：一个容器中有 100L 水，初始含盐 10kg。以 3L/min 的速度注入含盐 0.5kg/L 的盐水，同时以 3L/min 的速度流出混合后的液体。求容器中盐量随时间的变化。

**解**：
- 设 $Q(t)$ 为 t 时刻的盐量
- 流入速率：$3 \times 0.5 = 1.5$ kg/min
- 流出速率：$3 \times \frac{Q(t)}{100} = \frac{3Q(t)}{100}$ kg/min
- 微分方程：$\frac{dQ}{dt} = 1.5 - \frac{3Q}{100}$
- 分离变量：$\frac{dQ}{1.5 - 0.03Q} = dt$
- 积分：$-\frac{1}{0.03}\ln|1.5 - 0.03Q| = t + C$
- 代入初始条件 $Q(0) = 10$，解得 $Q(t) = 50 - 40e^{-0.03t}$

## 8. AP微积分BC考试重点

1. **分离变量法**：能够识别并求解可分离变量的微分方程
2. **初始值问题**：能够求解给定初始条件的微分方程
3. **解的验证**：能够验证给定函数是否是微分方程的解
4. **斜率场**：能够绘制和理解斜率场，识别平衡点
5. **欧拉方法**：能够使用欧拉方法近似求解微分方程
6. **一阶线性微分方程**：能够使用积分因子法求解
7. **微分方程的应用**：理解指数增长、冷却定律、逻辑斯谛增长等应用模型
8. **微分方程的解的性质**：理解解的存在性、唯一性等基本概念

## 9. 典型例题

### 9.1 分离变量法

**题目**：解初始值问题 $\frac{dy}{dx} = \frac{x^2}{y}$，$y(0) = 2$

**解**：
1. 分离变量：$y \, dy = x^2 \, dx$
2. 积分：$\frac{y^2}{2} = \frac{x^3}{3} + C$
3. 代入初始条件：$\frac{2^2}{2} = 0 + C$，得 $C = 2$
4. 解出 y：$\frac{y^2}{2} = \frac{x^3}{3} + 2$
   $$y^2 = \frac{2x^3}{3} + 4$$
   $$y = \sqrt{\frac{2x^3}{3} + 4} \quad (\text{取正值，因为 } y(0) = 2 > 0)$$

### 9.2 验证解

**题目**：验证 $y = x e^x$ 是否是 $y' - y = e^x$ 的解

**解**：
- $y = x e^x$
- $y' = e^x + x e^x = (1 + x)e^x$
- $y' - y = (1 + x)e^x - x e^x = e^x$
- 因此 $y = x e^x$ 是解

### 9.3 欧拉方法

**题目**：使用欧拉方法近似求解 $\frac{dy}{dx} = 2x - y$，初始条件 $y(0) = 1$，步长 $h = 0.2$，计算 $y(0.4)$ 的近似值。

**解**：
1. $x_0 = 0$，$y_0 = 1$
2. 第一步：
   - $f(x_0, y_0) = 2(0) - 1 = -1$
   - $y_1 = 1 + 0.2 \times (-1) = 0.8$
   - $x_1 = 0.2$
3. 第二步：
   - $f(x_1, y_1) = 2(0.2) - 0.8 = 0.4 - 0.8 = -0.4$
   - $y_2 = 0.8 + 0.2 \times (-0.4) = 0.72$
   - $x_2 = 0.4$
4. 因此 $y(0.4) \approx 0.72$

### 9.4 一阶线性微分方程

**题目**：解微分方程 $\frac{dy}{dx} + \frac{y}{x} = x^2$，$x > 0$

**解**：
1. 标准形式：$P(x) = \frac{1}{x}$，$Q(x) = x^2$
2. 积分因子：
   $$I(x) = e^{\int \frac{1}{x} \, dx} = e^{\ln x} = x$$
3. 方程两边乘 x：
   $$x\frac{dy}{dx} + y = x^3$$
4. 左边写成：
   $$\frac{d}{dx}[xy] = x^3$$
5. 积分：
   $$xy = \int x^3 \, dx = \frac{x^4}{4} + C$$
6. 解出 y：
   $$y = \frac{x^3}{4} + \frac{C}{x}$$
